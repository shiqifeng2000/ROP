/*! bas-server - v1.1.0 - 2017-06-16
* Copyright (c) 2017 ; Licensed  */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(require,module,exports){var toString=Object.prototype.toString;module.exports="object"==typeof JSON&&"[object JSON]"===toString.call(JSON)?JSON:function(JSON){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return rx_escapable.lastIndex=0,rx_escapable.test(a)?'"'+a.replace(rx_escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function objectToJSON(a){switch(toString.call(a)){case"[object Date]":return isFinite(a.valueOf())?a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z":null;case"[object Boolean]":case"[object String]":case"[object Number]":return a.valueOf()}return a}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&(i=objectToJSON(i)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===toString.call(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],(e=str(d,i))&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i))&&g.push(quote(d)+(gap?": ":":")+e);return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;return"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}),JSON}({})},{}],2:[function(a,b,c){b.exports={LIB_VERSION:"1.2.0",LIB_KEY:"RXSTREAM201607",sendLimit:10,crossSubDomain:!0,loadTime:new Date,apiHost:"https://fenxi.ruixuesoft.com",appId:35}},{}],3:[function(a,b,c){function d(){return h.getSession("CURRENT_EVENT_ID")}function e(a){h.setSession("CURRENT_EVENT_ID",a)}var f=a("./config"),g=a("./utils"),h=a("./store"),i=a("./jMd5"),j=a("./JSON"),k={SENDING:"monitor_sending",SEND:"monitor_send",AUTHING:"monitor_authing",AUTH:"monitor_auth",SENDINGDATALEN:"monitor_sending_len"},l={_lockTimer:null,_lockState:!1,cbs:[],exec:function(a){var b=this;b.cbs.push(a),b._lockTimer||(b._lockTimer=setInterval(function(){if(!(b._lockState||b.cbs.length<=0)){b._lockState=!0;b.cbs.shift()(),g.log("队列函数数量："+b.cbs.length),0===b.cbs.length&&(clearInterval(b._lockTimer),b._lockTimer=null),b._lockState=!1}},0))}};b.exports={checkOption:{regChecks:{regName:/^((?!^uniqueId$|^originalId$|^time$|^properties$|^id$|^firstId$|^secondId$|^users$|^events$|^event$|^userId$|^date$|^datetime$)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i},checkPropertiesKey:function(a){var b=this,c=!0;return g.each(a,function(a,d){b.regChecks.regName.test(d)||(c=!1)}),c},check:function(a,b){return"string"==typeof this[a]?this[this[a]](b):this[a](b)},str:function(a){return!!g.isString(a)||(g.log("请检查参数格式,必须是字符串"),!1)},properties:function(a){return g.validateProperties(a),!a||(g.isObject(a)?!!this.checkPropertiesKey(a)||(g.log("properties里的key必须是由字符串数字_组成"),!1):(g.log("properties可以没有，但有的话必须是对象"),!1))},subject:function(a){return g.validateProperties(a),!a||(g.isObject(a)?!!this.checkPropertiesKey(a)||(g.log("subject里的key必须是由字符串数字_组成"),!1):(g.log("subject可以没有，但有的话必须是对象"),!1))},object:function(a){return g.validateProperties(a),!a||(g.isObject(a)?!!this.checkPropertiesKey(a)||(g.log("object里的key必须是由字符串数字_组成"),!1):(g.log("object可以没有，但有的话必须是对象"),!1))},propertiesMust:function(a){return g.validateProperties(a),void 0===a||!g.isObject(a)||g.isEmptyObject(a)?(g.log("properties必须是对象且有值"),!1):!!this.checkPropertiesKey(a)||(g.log("properties里的key必须是由字符串数字_组成"),!1)},event:function(a){return!(!g.isString(a)||!this.regChecks.regName.test(a))||(g.log("请检查参数格式,必须是字符串,且eventName必须是字符串_开头"),!1)},test_id:"str",group_id:"str",uniqueId:function(a){return!(!g.isString(a)||!/^.{1,255}$/.test(a))||(g.log("uniqueId必须是不能为空，且小于255位的字符串"),!1)},userId:function(a){return!!(g.isString(a)||g.isNumber(a)&&/^.{1,255}$/.test(a))||(g.log("userId必须是不能为空，且小于255位的字符串"),!1)}},globalContext:{state:{},eventPool:[],get:function(a){return a?this.state[a]:this.state},set:function(a,b){this.state[a]=b},getEventPool:function(){return g.localStorage.parse(f.LIB_KEY+"EventPool"+f.appId,[])},setEventPool:function(a){g.localStorage.set(f.LIB_KEY+"EventPool"+f.appId,j.stringify(a))},pushEvent:function(a){var b=this;a.sending=!1,l.exec(function(){a.cid=g.UUID();var c=d();c&&(a.pid=c),e(a.cid);var f=b.getEventPool();f.push(a),b.setEventPool(f)})}},check:function(a){var b=!0;for(var c in a)if(!this.checkOption.check(c,a[c]))return!1;return b},send:function(a){var b=this,c={properties:{},subject:{},object:{}};if(g.extend(c,a),g.isObject(a.properties)&&!g.isEmptyObject(a.properties)&&g.extend(c.properties,a.properties),g.isObject(a.subject)&&!g.isEmptyObject(a.subject)&&g.extend(c.subject,a.subject),g.isObject(a.object)&&!g.isEmptyObject(a.object)&&g.extend(c.object,a.object),!a.action||"profile"!==a.action.slice(0,7)){var d={b_dollar_screen_orientation:window.screen.msOrientation||(window.screen.orientation?window.screen.orientation.type:"unspecified")};g.extend(c.properties,d,h.getProps(),h.getSessionProps(),g.info.currentProps,g.info.properties()),g.extend(c.subject,h.getSubject(),h.getSessionSubject(),g.info.currentSubject),g.extend(c.object,h.getObject(),h.getSessionObject(),g.info.currentObject)}c.time=g.formatDate(new Date),g.searchObjDate(c),g.log("追踪到事件：\r\n"+j.stringify(c,null,4)),b.globalContext.pushEvent(c),setTimeout(function(){b.monitor(c.sly)},10)},monitor:function(a){var b=this;if(a)return void this.path(!0);var c=h.getSession(),d=c[k.AUTH],e=c[k.AUTHING],f=c[k.SENDING];d?f||this.path():e||this.auth(function(a){a&&b.path()})},auth:function(a){var b=f.apiHost+"/token/"+f.appId+"?randomId="+h.getSessionId()+"&domain="+h.getDomain();h.setSession(k.AUTHING,!0),g.ajax({url:b,type:"GET",cors:!0,success:function(a){var b=a,c=200===b.code;h.setSession(k.AUTH,c),c?h.setSession("token",b.token):g.log(b.msg||b.message)},error:function(a){g.log(a.status),g.log(a.statusText)},complete:function(b){h.setSession(k.AUTHING,!1);var c=h.getSession(k.AUTH);a&&a(c)}})},path:function(a,b){var c=this,d=h.getSession(),e=d[k.AUTH],i=d[k.SENDING];if(e&&!i){var j=f.apiHost+"/receive",l=f.sendLimit||1;h.setSession(k.SENDING,!0);var m=c.getWaitSendEvents(),n=m.length,o=[];if(!a&&n<l)return void h.setSession(k.SENDING,!1);g.each(m,function(a){a.sending=!0,o.push(a.cid)});var p=c.getPackingEvents(m);g.ajax({url:j,type:"POST",cors:!0,contentType:"application/json",data:p,success:function(a){try{g.isEmptyObject(a)||200===a.code?c.removeSendedEvents(o):402===a.code?(h.setSession(k.AUTH,!1),c.auth(function(a){a&&c.path()})):c.resetUnsendedEvents(o)}catch(a){g.log("事件发送返回消息错误")}},error:function(a){g.log(a.status),g.log(a.statusText)},complete:function(){h.setSession(k.SENDING,!1),g.log("事件发送完毕.")}}),a&&(c.removeSendedEvents(o),h.setSession(k.SENDING,!1))}},getWaitSendEvents:function(){var a=this,b=a.globalContext.getEventPool(),c=[];return c=g.arrayFilter(b,function(a,b,c){return!a.sending}),g.log("获取到待发送数据：\r\n"+j.stringify(c,null,4)),c},removeSendedEvents:function(a){var b=this;l.exec(function(){var c=b.globalContext.getEventPool();c=g.arrayFilter(c,function(b,c,d){return-1===a.indexOf(b.cid)}),b.globalContext.setEventPool(c)})},resetUnsendedEvents:function(a){var b=this;l.exec(function(){var c=b.globalContext.getEventPool();g.each(c,function(b){a.indexOf(b.cid)>=0&&(b.sending=!1)}),b.globalContext.setEventPool(c)})},getPackingEvents:function(a){var b=h.getSession(),c=b.token,d=b.sessionId,e=h.getDeviceId(),k=j.stringify(a),l=h.get(),m=j.stringify({appId:f.appId,uniqueId:e,userId:l?l.userId:"",events:k}),n=i(m+c),o=j.stringify({datatime:g.formatDate(new Date),lib:"js",sign:n,appId:f.appId,randomId:d,data:m});return g.log("发送事件数据：\r\n"+j.stringify(a,null,4)),o}}},{"./JSON":1,"./config":2,"./jMd5":5,"./store":8,"./utils":10}],4:[function(a,b,c){var d=a("./utils"),e=a("./JSON"),f=document.documentElement,g=/^(A|BUTTON)$/,h={addEvent:window.addEventListener?function(a,b,c){a.addEventListener(b,c,!0)}:function(a,b,c){a.attachEvent("on"+b,c)},innerText:"innerText"in f?function(a){return a.innerText}:function(a){return a.textContent},iAncestorTag:function(a,b,c){b.test||(b=b.toUpperCase()),c||(c=document);do{if(b.test?b.test(a.tagName):a.tagName===b)return a}while(a!==c&&(a=a.parentNode))},BUTTON_TYPE:{button:!0,image:!0,submit:!0,reset:!0},getClickPreset:function(a){a||(a=window.event);var b,c,f,i,j,k,l,m,n=a.target||a.srcElement,o=n.tagName;switch(o){case"INPUT":f=n.type,h.BUTTON_TYPE[f]&&(k=this.getDomSelector(n),m=this.getDomSize(n),l=this.getDomEventOffset(a,n),c={event:"btn_click",category:"click",properties:{b_dom_path:k,b_offset_x:l.offsetX,b_offset_y:l.offsetY,b_dom_width:m.width,b_dom_height:m.height,b_btn_type:f,b_btn_text:n.value,b_btn_name:n.getAttribute("name")||"",b_btn_value:n.getAttribute("value")||""}});break;default:var b=h.iAncestorTag(n,g);if(b)switch(k=this.getDomSelector(b),m=this.getDomSize(b),l=this.getDomEventOffset(a,b),b.tagName){case"BUTTON":i=d.trim(h.innerText(b)),c={event:"btn_click",category:"click",properties:{b_dom_path:k,b_offset_x:l.offsetX,b_offset_y:l.offsetY,b_dom_width:m.width,b_dom_height:m.height,b_btn_type:b.type,b_btn_text:i,b_btn_name:b.getAttribute("name")||"",b_btn_value:b.getAttribute("value")||""}};break;case"A":i=d.trim(h.innerText(b)),j=b.href,c={event:"link_click",category:"click",properties:{b_dom_path:k,b_offset_x:l.offsetX,b_offset_y:l.offsetY,b_dom_width:m.width,b_dom_height:m.height,b_link_url:j,b_link_text:i}}}else k=this.getDomSelector(n),m=this.getDomSize(n),l=this.getDomEventOffset(a,n),c={event:"element_click",category:"click",properties:{b_dom_path:k,b_offset_x:l.offsetX,b_offset_y:l.offsetY,b_dom_width:m.width,b_dom_height:m.height}}}return c&&(c.properties.b_clientX=a.clientX,c.properties.b_clientY=a.clientY),c},getPageSize:function(){var a,b;window.innerHeight&&window.scrollMaxY?(a=window.innerWidth+window.scrollMaxX,b=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(a=document.body.scrollWidth,b=document.body.scrollHeight):document.body&&(a=document.body.offsetWidth,b=document.body.offsetHeight);var c,d;return window.innerHeight?(c=window.innerWidth,d=window.innerHeight):document.documentElement&&document.documentElement.clientHeight?(c=document.documentElement.clientWidth,d=document.documentElement.clientHeight):document.body&&(c=document.body.clientWidth,d=document.body.clientHeight),{PageWidth:a<c?c:a,PageHeight:b<d?d:b,WinWidth:c,WinHeight:d}},getPageScroll:function(){var a,b;return window.pageYOffset?(b=window.pageYOffset,a=window.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(a=document.documentElement.scrollLeft,b=document.documentElement.scrollTop):document.body&&(a=document.body.scrollLeft,b=document.body.scrollTop),{b_scrollX:a,b_scrollY:b}},getDomSelector:function(a){var b=a.nodeName.toLowerCase();if("body"==b||"html"==b)return"body";var c=a.parentNode;if(a.getAttribute("id"))return this.getDomSelector(c)+">#"+a.getAttribute("id");if(("input"==b||"select"==b||"textarea"==b||"button"==b)&&a.getAttribute("name"))return this.getDomSelector(c)+">"+b+":input[name='"+a.getAttribute("name")+"']";for(var d=[],e=0;e<c.children.length;e++){var f=c.children[e];f.nodeName&&f.nodeName.toLowerCase()==b&&d.push(f)}for(e=0;e<d.length;e++)if(d[e]==a)return this.getDomSelector(c)+">"+b+":eq("+e+")"},getDomOffset:function(a){var b={top:0,left:0};return void 0!==a.getBoundingClientRect?(b=document.documentElement,a=a.getBoundingClientRect(),b={top:a.top+(window.pageYOffset||b.scrollTop)-(b.clientTop||0),left:a.left+(window.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):(b.top+=a.offsetTop,b.left+=a.offsetLeft,a.offsetParent&&(a=this.getDomOffset(a.offsetParent),b.top+=a.top,b.left+=a.left),b.top<0&&(b.top=0),b.left<0&&(b.left=0),b.top=isNaN(b.top)?0:parseInt(b.top,10),b.left=isNaN(b.left)?0:parseInt(b.left,10)),b.top=Math.round(b.top),b.left=Math.round(b.left),b},getDomEventOffset:function(a,b){var c={};if(a.offsetX&&a.offsetY)c.offsetX=a.offsetX,c.offsetY=a.offsetY;else{var d=b.getBoundingClientRect();c.offsetX=a.clientX-d.left,c.offsetY=a.clientY-d.top}return c},getDomSize:function(a){var b={};return b.width=a.offsetWidth,b.height=a.offsetHeight,b}};b.exports=h},{"./JSON":1,"./utils":10}],5:[function(a,b,c){var d=function(a,b){return a<<b|a>>>32-b},e=function(a,b){var c,d,e,f,g;return e=2147483648&a,f=2147483648&b,c=1073741824&a,d=1073741824&b,g=(1073741823&a)+(1073741823&b),c&d?2147483648^g^e^f:c|d?1073741824&g?3221225472^g^e^f:1073741824^g^e^f:g^e^f},f=function(a,b,c){return a&b|~a&c},g=function(a,b,c){return a&c|b&~c},h=function(a,b,c){return a^b^c},i=function(a,b,c){return b^(a|~c)},j=function(a,b,c,g,h,i,j){return a=e(a,e(e(f(b,c,g),h),j)),e(d(a,i),b)},k=function(a,b,c,f,h,i,j){return a=e(a,e(e(g(b,c,f),h),j)),e(d(a,i),b)},l=function(a,b,c,f,g,i,j){return a=e(a,e(e(h(b,c,f),g),j)),e(d(a,i),b)},m=function(a,b,c,f,g,h,j){return a=e(a,e(e(i(b,c,f),g),j)),e(d(a,h),b)},n=function(a){for(var b,c=a.length,d=c+8,e=(d-d%64)/64,f=16*(e+1),g=Array(f-1),h=0,i=0;i<c;)b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|a.charCodeAt(i)<<h,i++;return b=(i-i%4)/4,h=i%4*8,g[b]=g[b]|128<<h,g[f-2]=c<<3,g[f-1]=c>>>29,g},o=function(a){var b,c,d="",e="";for(c=0;c<=3;c++)b=a>>>8*c&255,e="0"+b.toString(16),d+=e.substr(e.length-2,2);return d},p=function(a){a=a.replace(/\x0d\x0a/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b};b.exports=function(a){var b,c,d,f,g,h,i,q,r,s=Array(),t=7,u=12,v=17,w=22,x=5,y=9,z=14,A=20,B=4,C=11,D=16,E=23,F=6,G=10,H=15,I=21;for(a=p(a),s=n(a),h=1732584193,i=4023233417,q=2562383102,r=271733878,b=0;b<s.length;b+=16)c=h,d=i,f=q,g=r,h=j(h,i,q,r,s[b+0],t,3614090360),r=j(r,h,i,q,s[b+1],u,3905402710),q=j(q,r,h,i,s[b+2],v,606105819),i=j(i,q,r,h,s[b+3],w,3250441966),h=j(h,i,q,r,s[b+4],t,4118548399),r=j(r,h,i,q,s[b+5],u,1200080426),q=j(q,r,h,i,s[b+6],v,2821735955),i=j(i,q,r,h,s[b+7],w,4249261313),h=j(h,i,q,r,s[b+8],t,1770035416),r=j(r,h,i,q,s[b+9],u,2336552879),q=j(q,r,h,i,s[b+10],v,4294925233),i=j(i,q,r,h,s[b+11],w,2304563134),h=j(h,i,q,r,s[b+12],t,1804603682),r=j(r,h,i,q,s[b+13],u,4254626195),q=j(q,r,h,i,s[b+14],v,2792965006),i=j(i,q,r,h,s[b+15],w,1236535329),h=k(h,i,q,r,s[b+1],x,4129170786),r=k(r,h,i,q,s[b+6],y,3225465664),q=k(q,r,h,i,s[b+11],z,643717713),i=k(i,q,r,h,s[b+0],A,3921069994),h=k(h,i,q,r,s[b+5],x,3593408605),r=k(r,h,i,q,s[b+10],y,38016083),q=k(q,r,h,i,s[b+15],z,3634488961),i=k(i,q,r,h,s[b+4],A,3889429448),h=k(h,i,q,r,s[b+9],x,568446438),r=k(r,h,i,q,s[b+14],y,3275163606),q=k(q,r,h,i,s[b+3],z,4107603335),i=k(i,q,r,h,s[b+8],A,1163531501),h=k(h,i,q,r,s[b+13],x,2850285829),r=k(r,h,i,q,s[b+2],y,4243563512),q=k(q,r,h,i,s[b+7],z,1735328473),i=k(i,q,r,h,s[b+12],A,2368359562),h=l(h,i,q,r,s[b+5],B,4294588738),r=l(r,h,i,q,s[b+8],C,2272392833),q=l(q,r,h,i,s[b+11],D,1839030562),i=l(i,q,r,h,s[b+14],E,4259657740),h=l(h,i,q,r,s[b+1],B,2763975236),r=l(r,h,i,q,s[b+4],C,1272893353),q=l(q,r,h,i,s[b+7],D,4139469664),i=l(i,q,r,h,s[b+10],E,3200236656),h=l(h,i,q,r,s[b+13],B,681279174),r=l(r,h,i,q,s[b+0],C,3936430074),q=l(q,r,h,i,s[b+3],D,3572445317),i=l(i,q,r,h,s[b+6],E,76029189),h=l(h,i,q,r,s[b+9],B,3654602809),r=l(r,h,i,q,s[b+12],C,3873151461),q=l(q,r,h,i,s[b+15],D,530742520),i=l(i,q,r,h,s[b+2],E,3299628645),h=m(h,i,q,r,s[b+0],F,4096336452),r=m(r,h,i,q,s[b+7],G,1126891415),q=m(q,r,h,i,s[b+14],H,2878612391),i=m(i,q,r,h,s[b+5],I,4237533241),h=m(h,i,q,r,s[b+12],F,1700485571),r=m(r,h,i,q,s[b+3],G,2399980690),q=m(q,r,h,i,s[b+10],H,4293915773),i=m(i,q,r,h,s[b+1],I,2240044497),h=m(h,i,q,r,s[b+8],F,1873313359),r=m(r,h,i,q,s[b+15],G,4264355552),q=m(q,r,h,i,s[b+6],H,2734768916),i=m(i,q,r,h,s[b+13],I,1309151649),h=m(h,i,q,r,s[b+4],F,4149444226),r=m(r,h,i,q,s[b+11],G,3174756917),q=m(q,r,h,i,s[b+2],H,718787259),i=m(i,q,r,h,s[b+9],I,3951481745),h=e(h,c),i=e(i,d),q=e(q,f),r=e(r,g);return(o(h)+o(i)+o(q)+o(r)).toLowerCase()}},{}],6:[function(a,b,c){var d=a("./utils"),e=a("./rxStream"),f=(a("./JSON"),{sendLimit:10,crossSubDomain:!0,loadTime:1*new Date,autoTrack:!0,showLog:!1}),g=window[e.config.LIB_KEY]||e.config.LIB_KEY;g&&(g=window[g]),g.para&&d.extend(f,g.para),f.loadTime=g.lt||1*new Date,d.extend(g,e),g.init(f)},{"./JSON":1,"./rxStream":7,"./utils":10}],7:[function(a,b,c){var d=a("./utils"),e=a("./store"),f=a("./core"),g=a("./dom"),h=a("./config"),i=(a("./JSON"),a("./uaDetector")),j=a("./widget/heatmap/parser"),k={};k._=d,k.config=h,k.core=f;var l={element_click:"click",link_click:"click",btn_click:"click",view_page:"load",leave_page:"load"},m={getUtm:function(){return d.info.campaignParams()},getStayTime:function(){return(new Date-h.loadTime)/1e3},setInitReferrer:function(){var a=document.referrer;e.setPropsOnce({b_dollar_page_referrer:a,b_dollar_referrer_domain:d.info.referringDomain(a)})},setSessionReferrer:function(){var a=document.referrer;e.setSessionPropsOnce({b_dollar_session_referrer:a,b_dollar_session_referrer_domain:d.info.referringDomain(a)})},setDefaultAttr:function(){var a=document.body&&document.body.getElementsByTagName("h1"),b="";a&&a.length&&a.length>0&&(b=g.innerText(a[0])),d.info.register({b_dollar_page_url:location.href,b_dollar_referrer:document.referrer,b_dollar_referring_domain:d.info.referringDomain(document.referrer),b_dollar_page_url_path:location.pathname,b_dollar_page_h1:b,b_dollar_page_title:document.title})},autoTrack:function(){var a=this,b=d.info.campaignParams();g.addEvent(window,"load",function(){var c=m.getStayTime();f.globalContext.set("pageLoadTime",c),a.track("view_page",{properties:d.extend({b_page_load_time:c},b),subject:{},object:{}}),d.log("页面加载时间："+c)}),g.addEvent(window,"orientationchange",function(){180!=window.orientation&&0!=window.orientation||e.setProps({b_dollar_screen_orientation:"portrait"}),90!=window.orientation&&-90!=window.orientation||e.setProps({b_dollar_screen_orientation:"landscape"})});var c=1*new Date;g.addEvent(document,"click",function(b){var e=1*new Date;if(!(e-c<=1e3)){c=e;var f=g.getClickPreset(b);f&&a.track(f.event,{properties:d.extend({},f.properties),subject:{},object:{}})}}),g.addEvent(window,"beforeunload",function(b){var c=f.globalContext.get("pageLoadTime"),e=m.getStayTime(),h=g.getPageScroll(),i=g.getPageSize(),j=d.extend({b_page_load_time:c,b_page_stay_time:e,b_page_height:i.PageHeight,b_page_width:i.PageWidth},h);a.track("leave_page",{properties:j,subject:{},object:{}},!0),setTimeout(function(){},600)}),g.addEvent(window,"unload",function(a){setTimeout(function(){},100)})}};k.quick=function(){var a=Array.prototype.slice.call(arguments),b=a[0],c=a.slice(1);if("string"==typeof b&&m[b])return m[b].apply(this,c);"function"==typeof b?b.apply(this,c):d.log("quick方法中没有这个功能"+a[0])},k.autoTrack=function(){m.autoTrack.call(this)},k.track=function(a,b,c){if(f.check({event:a,properties:b.properties,subject:b.subject,object:b.object})){var e=l[a]||"customize";f.send(d.extend({action:"track",event:a,category:e,sly:c},b))}},k.setProfile=function(a){f.check({propertiesMust:a})&&f.send({action:"profile_set",properties:a})},k.setOnceProfile=function(a){f.check({propertiesMust:a})&&f.send({action:"profile_set_once",properties:a})},k.appendProfile=function(a){f.check({propertiesMust:a})&&(d.each(a,function(b,c){d.isString(b)?a[c]=[b]:d.isArray(b)||(delete a[c],d.log("appendProfile属性的值必须是字符串或者数组"))}),d.isEmptyObject(a)||f.send({action:"profile_append",properties:a}))},k.incrementProfile=function(a){function b(a){for(var b in a)if(!/-*\d+/.test(String(a[b])))return!1;return!0}var c=a;d.isString(a)&&(a={},a[c]=1),f.check({propertiesMust:a})&&(b(a)?f.send({action:"profile_increment",properties:a}):d.log("profile_increment的值只能是数字"))},k.deleteProfile=function(){f.send({action:"profile_delete"}),e.set("uniqueId",d.UUID())},k.unsetProfile=function(a){var b=a,c={};d.isString(a)&&(a=[],a.push(b)),d.isArray(a)?(d.each(a,function(a){d.isString(a)?c[a]=!0:d.log("profile_unset给的数组里面的值必须时string,已经过滤掉",a)}),f.send({action:"profile_unset",properties:c})):d.log("profile_unset的参数是数组")},k.identify=function(a,b){void 0===a?e.set("uniqueId",d.UUID()):f.check({uniqueId:a})?!0===b?e.set("uniqueId",a):e.change("uniqueId",a):d.log("identify的参数必须是字符串")},k.userIdentify=function(a,b,c){void 0===a?(e.set("uniqueId",d.UUID()),e.set("userId",""),e.clearSubject()):f.check({userId:a,subject:b})?!0===c?(e.set("userId",a),d.isEmptyObject(b)||e.setSubject(b)):(e.change("userId",a),e.change("subject",b)):d.log("userIdentify的参数输入有误")},k.trackSignup=function(a,b,c){c=c||{subject:{},object:{},properties:{}},f.check({userId:a,event:b,properties:c.properties||{},subject:c.subject||{},object:c.object||{}})&&(k.userIdentify(a,{},!0),f.send({action:"trackSignup",event:b,properties:c.properties||{},subject:c.subject||{},object:c.object||{}}))},k.trackAbtest=function(a,b){f.check({test_id:a,group_id:b})&&f.send({action:"trackAbtest",properties:{test_id:a,group_id:b}})},k.register=function(a){f.check({properties:a})?e.setProps(a):d.log("register输入的参数有误")},k.registerOnce=function(a){f.check({properties:a})?e.setPropsOnce("props",a):d.log("registerOnce输入的参数有误")},k.registerSession=function(a){f.check({properties:a})?e.setSessionProps(a):d.log("registerSession输入的参数有误")},k.registerSessionOnce=function(a){f.check({properties:a})?e.setSessionPropsOnce(a):d.log("registerSessionOnce输入的参数有误")},k.getSessionId=function(){return e.getSessionId()},k.getUtils=function(){return d},k.getUADetector=function(){return i},k.preInit=function(){},k.inited=function(){k.loaded=!0},k.init=function(a){var b=this;b.preInit(),a&&!d.isEmptyObject(a)&&d.extend(b.config,a),e.init(),b._rx&&d.each(b._rx,function(a){b[a[0]].apply(b,Array.prototype.slice.call(a[1]))}),!0===b.config.autoTrack&&b.autoTrack(),j.parser(),b.inited()},b.exports=k},{"./JSON":1,"./config":2,"./core":3,"./dom":4,"./store":8,"./uaDetector":9,"./utils":10,"./widget/heatmap/parser":11}],8:[function(a,b,c){var d=a("./config"),e=a("./utils"),f=a("./JSON"),g=d.LIB_KEY;b.exports={getProps:function(){return this._state.props},getSessionProps:function(){return this._sessionState.props},getSubject:function(){return this._state.subject},getObject:function(){return this._state.object},getSessionSubject:function(){return this._sessionState.subject||{}},getSessionObject:function(){return this._sessionState.object||{}},getDeviceId:function(){return this._state.uniqueId},getSessionId:function(){return this._sessionState.sessionId},getDomain:function(){var a=this._state.domain;return a||(a=document.domain||window.location.host,this.setOnce("domain",a)),a},toState:function(a){var b=null;null!==a&&"object"==typeof(b=f.parse(a))&&(this._state=b)},initSessionState:function(){var a=e.cookie.get(g+"session"),b=null;null!==a&&"object"==typeof(b=f.parse(a))&&(this._sessionState=b)},get:function(a){return a?this._state[a]:this._state},getSession:function(a){return a?this._sessionState[a]:this._sessionState},set:function(a,b){this._state[a]=b,this.save()},setOnce:function(a,b){a in this._state||this.set(a,b)},setSession:function(a,b){this._sessionState[a]=b,this.sessionSave()},setSessionOnce:function(a,b){a in this._sessionState||this.setSession(a,b)},change:function(a,b){this._state[a]=b},sessionChange:function(a,b){this._sessionState[a]=b},setSessionProps:function(a){this._setSessionProps("props",a)},setSessionPropsOnce:function(a){this._setSessionPropsOnce("props",a)},setSessionSubject:function(a){this._setSessionProps("subject",a)},setSessionSubjectOnce:function(a){this._setSessionPropsOnce("subject",a)},clearSessionSubject:function(){this._sessionState.subject={},this.sessionSave()},setSessionObject:function(a){this._setSessionProps("object",a)},setSessionObjectOnce:function(a){this._setSessionPropsOnce("object",a)},clearSessionObject:function(){this._sessionState.object={},this.sessionSave()},setProps:function(a){this._setProps("props",a)},setPropsOnce:function(a){this._setPropsOnce("props",a)},setSubject:function(a){this._setProps("subject",a)},setSubjectOnce:function(a){this._setPropsOnce("subject",a)},clearSubject:function(){this._state.subject={},this.save()},setObject:function(a){this._setProps("subject",a)},setObjectOnce:function(a){this._setPropsOnce("subject",a)},clearObject:function(){this._state.object={},this.save()},_setProps:function(a,b){var c=this._state[a]||{};e.extend(c,b),this.set(a,c)},_setPropsOnce:function(a,b){var c=this._state[a]||{};e.coverExtend(c,b),this.set(a,c)},_setSessionProps:function(a,b){var c=this._sessionState[a]||{};e.extend(c,b),this.setSession(a,c)},_setSessionPropsOnce:function(a,b){var c=this._sessionState[a]||{};e.coverExtend(c,b),this.setSession(a,c)},sessionSave:function(a){a&&(this._sessionState=a),e.cookie.set(g+"session",f.stringify(this._sessionState),0,d.crossSubDomain)},save:function(){d.crossSubDomain?e.cookie.set(g+"jssdkcross",f.stringify(this._state),this._state.expires||730,!0):e.cookie.set(g+"jssdk",f.stringify(this._state),this._state.expires||730,!1)},_sessionState:{props:{},subject:{},object:{}},_state:{props:{},subject:{},object:{}},init:function(){var a=e.cookie.get(g+"jssdk"),b=e.cookie.get(g+"jssdkcross"),c=null;d.crossSubDomain?(c=b,null!==a&&(e.log("在根域且子域有值，删除子域的cookie"),e.cookie.remove(g+"jssdk",!1),e.cookie.remove(g+"jssdk",!0)),null===c&&null!==a&&(e.log("在根域且根域没值，子域有值，根域＝子域的值",a),c=a)):(e.log("在子域"),c=a),this.initSessionState(),null!==c?(this.toState(c),d.crossSubDomain&&null===b&&(e.log("在根域且根域没值，保存当前值到cookie中"),this.save())):(e.log("没有值，set值"),this.set("uniqueId",e.UUID())),this.setSessionOnce("sessionId",e.UUID())}}},{"./JSON":1,"./config":2,"./utils":10}],9:[function(a,b,c){function d(a){return Object.prototype.toString.call(a)}function e(a){return"[object Object]"===d(a)}function f(a){return"[object Function]"===d(a)}function g(a,b){for(var c=0,d=a.length;c<d&&!1!==b.call(a,a[c],c);c++);}function h(a){if(!s.test(a))return null;var b,c,d,e,f;if(-1!==a.indexOf("trident/")&&(b=/\btrident\/([0-9.]+)/.exec(a))&&b.length>=2){d=b[1];var g=b[1].split(".");g[0]=parseInt(g[0],10)+4,f=g.join(".")}b=s.exec(a),e=b[1];var h=b[1].split(".");return void 0===f&&(f=e),h[0]=parseInt(h[0],10)-4,c=h.join("."),void 0===d&&(d=c),{browserVersion:f,browserMode:e,engineVersion:d,engineMode:c,compatible:d!==c}}function i(a){if(o)try{var b=o.twGetRunPath.toLowerCase(),c=o.twGetSecurityID(n),d=o.twGetVersion(c);if(b&&-1===b.indexOf(a))return!1;if(d)return{version:d}}catch(a){}}function j(a,b,c){var g=f(b)?b.call(null,c):b;if(!g)return null;var h={name:a,version:m,codename:""},i=d(g);if(!0===g)return h;if("[object String]"===i){if(-1!==c.indexOf(g))return h}else{if(e(g))return g.hasOwnProperty("version")&&(h.version=g.version),h;if(g.exec){var j=g.exec(c);if(j)return j.length>=2&&j[1]?h.version=j[1].replace(/_/g,"."):h.version=m,h}}}function k(a,b,c,d){var e=A;g(b,function(b){var c=j(b[0],b[1],a);if(c)return e=c,!1}),c.call(d,e.name,e.version)}var l=(a("./JSON"),{}),m="-1",n=window,o=n.external,p=n.navigator.userAgent||"",q=n.navigator.appVersion||"",r=n.navigator.vendor||"",s=/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/,t=/\bbb10\b.+?\bversion\/([\d.]+)/,u=/\bblackberry\b.+\bversion\/([\d.]+)/,v=/\bblackberry\d+\/([\d.]+)/,w=[["nokia",function(a){return-1!==a.indexOf("nokia ")?/\bnokia ([0-9]+)?/:/\bnokia([a-z0-9]+)?/}],["samsung",function(a){return-1!==a.indexOf("samsung")?/\bsamsung(?:[ \-](?:sgh|gt|sm))?-([a-z0-9]+)/:/\b(?:sgh|sch|gt|sm)-([a-z0-9]+)/}],["wp",function(a){return-1!==a.indexOf("windows phone ")||-1!==a.indexOf("xblwp")||-1!==a.indexOf("zunewp")||-1!==a.indexOf("windows ce")}],["pc","windows"],["ipad","ipad"],["ipod","ipod"],["iphone",/\biphone\b|\biph(\d)/],["mac","macintosh"],["mi",/\bmi[ \-]?([a-z0-9 ]+(?= build|\)))/],["hongmi",/\bhm[ \-]?([a-z0-9]+)/],["aliyun",/\baliyunos\b(?:[\-](\d+))?/],["meizu",function(a){return a.indexOf("meizu")>=0?/\bmeizu[\/ ]([a-z0-9]+)\b/:/\bm([0-9cx]{1,4})\b/}],["nexus",/\bnexus ([0-9s.]+)/],["huawei",function(a){var b=/\bmediapad (.+?)(?= build\/huaweimediapad\b)/;return-1!==a.indexOf("huawei-huawei")?/\bhuawei\-huawei\-([a-z0-9\-]+)/:b.test(a)?b:/\bhuawei[ _\-]?([a-z0-9]+)/}],["lenovo",function(a){return-1!==a.indexOf("lenovo-lenovo")?/\blenovo\-lenovo[ \-]([a-z0-9]+)/:/\blenovo[ \-]?([a-z0-9]+)/}],["zte",function(a){return/\bzte\-[tu]/.test(a)?/\bzte-[tu][ _\-]?([a-su-z0-9\+]+)/:/\bzte[ _\-]?([a-su-z0-9\+]+)/}],["vivo",/\bvivo(?: ([a-z0-9]+))?/],["htc",function(a){return/\bhtc[a-z0-9 _\-]+(?= build\b)/.test(a)?/\bhtc[ _\-]?([a-z0-9 ]+(?= build))/:/\bhtc[ _\-]?([a-z0-9 ]+)/}],["oppo",/\boppo[_]([a-z0-9]+)/],["konka",/\bkonka[_\-]([a-z0-9]+)/],["sonyericsson",/\bmt([a-z0-9]+)/],["coolpad",/\bcoolpad[_ ]?([a-z0-9]+)/],["lg",/\blg[\-]([a-z0-9]+)/],["android",/\bandroid\b|\badr\b/],["blackberry",function(a){return a.indexOf("blackberry")>=0?/\bblackberry\s?(\d+)/:"bb10"}]],x=[["wp",function(a){return-1!==a.indexOf("windows phone ")?/\bwindows phone (?:os )?([0-9.]+)/:-1!==a.indexOf("xblwp")?/\bxblwp([0-9.]+)/:-1!==a.indexOf("zunewp")?/\bzunewp([0-9.]+)/:"windows phone"}],["windows",/\bwindows nt ([0-9.]+)/],["macosx",/\bmac os x ([0-9._]+)/],["ios",function(a){return/\bcpu(?: iphone)? os /.test(a)?/\bcpu(?: iphone)? os ([0-9._]+)/:-1!==a.indexOf("iph os ")?/\biph os ([0-9_]+)/:/\bios\b/}],["yunos",/\baliyunos ([0-9.]+)/],["android",function(a){return a.indexOf("android")>=0?/\bandroid[ \/-]?([0-9.x]+)?/:a.indexOf("adr")>=0?a.indexOf("mqqbrowser")>=0?/\badr[ ]\(linux; u; ([0-9.]+)?/:/\badr(?:[ ]([0-9.]+))?/:"android"}],["chromeos",/\bcros i686 ([0-9.]+)/],["linux","linux"],["windowsce",/\bwindows ce(?: ([0-9.]+))?/],["symbian",/\bsymbian(?:os)?\/([0-9.]+)/],["blackberry",function(a){var b=a.match(t)||a.match(u)||a.match(v);return b?{version:b[1]}:"blackberry"}]],y=[["edgehtml",/edge\/([0-9.]+)/],["trident",s],["blink",function(){return"chrome"in n&&"CSS"in n&&/\bapplewebkit[\/]?([0-9.+]+)/}],["webkit",/\bapplewebkit[\/]?([0-9.+]+)/],["gecko",function(a){var b;if(b=a.match(/\brv:([\d\w.]+).*\bgecko\/(\d+)/))return{version:b[1]+"."+b[2]}}],["presto",/\bpresto\/([0-9.]+)/],["androidwebkit",/\bandroidwebkit\/([0-9.]+)/],["coolpadwebkit",/\bcoolpadwebkit\/([0-9.]+)/],["u2",/\bu2\/([0-9.]+)/],["u3",/\bu3\/([0-9.]+)/]],z=[["edge",/edge\/([0-9.]+)/],["sogou",function(a){return a.indexOf("sogoumobilebrowser")>=0?/sogoumobilebrowser\/([0-9.]+)/:a.indexOf("sogoumse")>=0||/ se ([0-9.x]+)/}],["theworld",function(){var a=i("theworld");return void 0!==a?a:"theworld"}],["360",function(a){var b=i("360se");return void 0!==b?b:-1!==a.indexOf("360 aphone browser")?/\b360 aphone browser \(([^\)]+)\)/:/\b360(?:se|ee|chrome|browser)\b/}],["maxthon",function(){try{if(o&&(o.mxVersion||o.max_version))return{version:o.mxVersion||o.max_version}}catch(a){}return/\b(?:maxthon|mxbrowser)(?:[ \/]([0-9.]+))?/}],["micromessenger",/\bmicromessenger\/([\d.]+)/],["qq",/\bm?qqbrowser\/([0-9.]+)/],["green","greenbrowser"],["tt",/\btencenttraveler ([0-9.]+)/],["liebao",function(a){if(a.indexOf("liebaofast")>=0)return/\bliebaofast\/([0-9.]+)/;if(-1===a.indexOf("lbbrowser"))return!1;var b;try{o&&o.LiebaoGetVersion&&(b=o.LiebaoGetVersion())}catch(a){}return{version:b||m}}],["tao",/\btaobrowser\/([0-9.]+)/],["coolnovo",/\bcoolnovo\/([0-9.]+)/],["saayaa","saayaa"],["baidu",/\b(?:ba?idubrowser|baiduhd)[ \/]([0-9.x]+)/],["ie",s],["mi",/\bmiuibrowser\/([0-9.]+)/],["opera",function(a){var b=/\bopera.+version\/([0-9.ab]+)/,c=/\bopr\/([0-9.]+)/;return b.test(a)?b:c}],["oupeng",/\boupeng\/([0-9.]+)/],["yandex",/yabrowser\/([0-9.]+)/],["ali-ap",function(a){return a.indexOf("aliapp")>0?/\baliapp\(ap\/([0-9.]+)\)/:/\balipayclient\/([0-9.]+)\b/}],["ali-ap-pd",/\baliapp\(ap-pd\/([0-9.]+)\)/],["ali-am",/\baliapp\(am\/([0-9.]+)\)/],["ali-tb",/\baliapp\(tb\/([0-9.]+)\)/],["ali-tb-pd",/\baliapp\(tb-pd\/([0-9.]+)\)/],["ali-tm",/\baliapp\(tm\/([0-9.]+)\)/],["ali-tm-pd",/\baliapp\(tm-pd\/([0-9.]+)\)/],["uc",function(a){return a.indexOf("ucbrowser/")>=0?/\bucbrowser\/([0-9.]+)/:a.indexOf("ubrowser/")>=0?/\bubrowser\/([0-9.]+)/:/\buc\/[0-9]/.test(a)?/\buc\/([0-9.]+)/:a.indexOf("ucweb")>=0?/\bucweb([0-9.]+)?/:/\b(?:ucbrowser|uc)\b/}],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["android",function(a){if(-1!==a.indexOf("android"))return/\bversion\/([0-9.]+(?: beta)?)/}],["blackberry",function(a){var b=a.match(t)||a.match(u)||a.match(v);return b?{version:b[1]}:"blackberry"}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["webview",/\bcpu(?: iphone)? os (?:[0-9._]+).+\bapplewebkit\b/],["firefox",/\bfirefox\/([0-9.ab]+)/],["nokia",/\bnokiabrowser\/([0-9.]+)/]],A={name:"na",version:m};l=function(a){a=(a||"").toLowerCase();var b={};k(a,w,function(a,c){var d=parseFloat(c);b.device={name:a,version:d,fullVersion:c},b.device[a]=d},b),k(a,x,function(a,c){var d=parseFloat(c);b.os={name:a,version:d,fullVersion:c},b.os[a]=d},b);var c=h(a);return k(a,y,function(a,d){var e=d;c&&(d=c.engineVersion||c.engineMode,e=c.engineMode);var f=parseFloat(d);b.engine={name:a,version:f,fullVersion:d,mode:parseFloat(e),fullMode:e,compatible:!!c&&c.compatible},b.engine[a]=f},b),k(a,z,function(a,d){var e=d;c&&("ie"===a&&(d=c.browserVersion),e=c.browserMode);var f=parseFloat(d);b.browser={name:a,version:f,fullVersion:d,mode:parseFloat(e),fullMode:e,compatible:!!c&&c.compatible},b.browser[a]=f},b),b}(p+" "+q+" "+r),b.exports=l},{"./JSON":1}],10:[function(a,b,c){var d=a("./config"),e=a("./JSON"),f=a("./uaDetector"),g=Array.prototype,h=Function.prototype,i=Object.prototype,j=g.slice,k=i.toString,l=i.hasOwnProperty,m=window.navigator,n=window.document,o=m.userAgent,p=d.LIB_VERSION,q=(d.LIB_KEY,h.bind,g.forEach),r=g.indexOf,s=Array.isArray,u={},v={},w=v.each=function(a,b,c){if(null==a)return!1;if(q&&a.forEach===q)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;d<e;d++)if(d in a&&b.call(c,a[d],d,a)===u)return!1}else for(var f in a)if(l.call(a,f)&&b.call(c,a[f],f,a)===u)return!1};v.extend=function(a){return w(j.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},v.coverExtend=function(a){return w(j.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&void 0===a[c]&&(a[c]=b[c])}),a},v.isArray=s||function(a){return"[object Array]"===k.call(a)},v.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(a){return!1}},v.isArguments=function(a){return!(!a||!l.call(a,"callee"))},v.toArray=function(a){return a?a.toArray?a.toArray():v.isArray(a)?j.call(a):v.isArguments(a)?j.call(a):v.values(a):[]},v.values=function(a){var b=[];return null==a?b:(w(a,function(a){b[b.length]=a}),b)},v.include=function(a,b){var c=!1;return null==a?c:r&&a.indexOf===r?-1!=a.indexOf(b):(w(a,function(a){if(c||(c=a===b))return u}),c)},v.includes=function(a,b){return-1!==a.indexOf(b)},v.arrayFilter=function(a,b){for(var c=-1,d=a?a.length:0,e=0,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[e++]=g)}return f},v.inherit=function(a,b){return a.prototype=new b,a.prototype.constructor=a,a.superclass=b.prototype,a},v.isObject=function(a){return"[object Object]"==k.call(a)},v.isEmptyObject=function(a){if(v.isObject(a)){for(var b in a)if(l.call(a,b))return!1;return!0}return!1};var x=/^\s+|\s+$/;v.trim="".trim?function(a){return a.trim()}:function(a){return a.replace(x)},v.isUndefined=function(a){return void 0===a},v.isString=function(a){return"[object String]"==k.call(a)},v.isDate=function(a){return"[object Date]"==k.call(a)},v.isBoolean=function(a){return"[object Boolean]"==k.call(a)},v.isNumber=function(a){return"[object Number]"==k.call(a)&&/[\d\.]+/.test(String(a))},v.encodeDates=function(a){return v.each(a,function(b,c){v.isDate(b)?a[c]=v.formatDate(b):v.isObject(b)&&(a[c]=v.encodeDates(b))}),a},v.formatDate=function(a){function b(a){return a<10?"0"+a:a}return[a.getFullYear(),"-",b(a.getMonth()+1),"-",b(a.getDate()),"T",b(a.getHours()),":",b(a.getMinutes()),":",b(a.getSeconds()),".",b(a.getMilliseconds()),"+08:00"].join("")},v.searchObjDate=function(a){v.isObject(a)&&v.each(a,function(b,c){v.isObject(b)?v.searchObjDate(a[c]):v.isDate(b)&&(a[c]=v.formatDate(b))})},v.validateProperties=function(a){return v.isObject(a)?(v.each(a,function(b,c){if(v.isArray(b)){var d=[];v.each(b,function(a){v.isString(a)?d.push(a):v.log("您的数据-",b,"的数组里的值必须是字符串,已经将其删除")}),0!==d.length?a[c]=d:(delete a[c],v.log("已经删除空的数组"))}v.isString(b)||v.isNumber(b)||v.isDate(b)||v.isBoolean(b)||v.isArray(b)||(v.log("您的数据-",b,"-格式不满足要求，我们已经将其删除"),delete a[c])}),a):a},v.generateNewProperties=function(a){var b={};return v.each(a,function(a,c){v.isString(a)&&a.length>0&&(b[c]=a)}),b},v.utf8Encode=function(a){a=(a+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var b,c,d,e="",f=0;for(b=c=0,f=a.length,d=0;d<f;d++){var g=a.charCodeAt(d),h=null;g<128?c++:h=g>127&&g<2048?String.fromCharCode(g>>6|192,63&g|128):String.fromCharCode(g>>12|224,g>>6&63|128,63&g|128),null!==h&&(c>b&&(e+=a.substring(b,c)),e+=h,b=c=d+1)}return c>b&&(e+=a.substring(b,a.length)),e},v.detector=f,v.base64Encode=function(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;a=v.utf8Encode(a);do{b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=b<<16|c<<8|d,e=i>>18&63,f=i>>12&63,g=i>>6&63,h=63&i,n[l++]=j.charAt(e)+j.charAt(f)+j.charAt(g)+j.charAt(h)}while(k<a.length);switch(m=n.join(""),a.length%3){case 1:m=m.slice(0,-2)+"==";break;case 2:m=m.slice(0,-1)+"="}return m},v.UUID=function(){var a=function(){for(var a=1*new Date,b=0;a==1*new Date;)b++;return a.toString(16)+b.toString(16)},b=function(){return Math.random().toString(16).replace(".","")},c=function(a){function b(a,b){var c,d=0;for(c=0;c<b.length;c++)d|=f[c]<<8*c;return a^d}var c,d,e=o,f=[],g=0;for(c=0;c<e.length;c++)d=e.charCodeAt(c),f.unshift(255&d),f.length>=4&&(g=b(g,f),f=[]);return f.length>0&&(g=b(g,f)),g.toString(16)};return function(){var d=(screen.height*screen.width).toString(16);return a()+"-"+b()+"-"+c()+"-"+d+"-"+a()}}(),v.getQueryParam=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+b+"=([^&#]*)",d=new RegExp(c),e=d.exec(a);return null===e||e&&"string"!=typeof e[1]&&e[1].length?"":decodeURIComponent(e[1]).replace(/\+/g," ")},v.concatQueryParam=function(a,b,c){var d="";-1!=a.indexOf("#")&&(d=a.split("#")[1],a=a.split("#")[0]),void 0!=c&&null!=c||(c="");var e="[\\?&]"+b+"=([^&#]*)",f=new RegExp(e),g=f.exec(a);return a=null===g||g&&"string"!=typeof g[1]&&g[1].length?-1!=a.indexOf("?")||-1!=a.indexOf("=")?a+"&"+b+"="+c:a+"?"+b+"="+c:a.replace(g[0],g[0].replace(g[1],c)),""!=d&&(a+="#"+d),a},v.xhr=function(a){var b;if(a&&(b=new XMLHttpRequest,b="withCredentials"in b?b:"undefined"!=typeof XDomainRequest?new XDomainRequest:t),XMLHttpRequest&&(b=new XMLHttpRequest),window.ActiveXObject)try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}return!("setRequestHeader"in b)&&(b.setRequestHeader=function(){}),b},v.ajax=function(a){function b(a){try{return e.parse(a)}catch(a){return{}}}var c=v.xhr(a.cors);if(a.type||(a.type=a.data?"POST":"GET"),a=v.extend({success:function(){},error:function(a,b,c){v.log(a.status),v.log(a.readyState),v.log(b)},complete:function(a){}},a),c.onreadystatechange=function(){4==c.readyState&&(c.status>=200&&c.status<300||304==c.status?a.success(b(c.responseText)):a.error(c),a.complete(c),c.onreadystatechange&&(c.onreadystatechange=null),c.onload&&(c.onload=null))},c.open(a.type,a.url,void 0===a.async||a.async),v.isObject(a.header))for(var d in a.header)c.setRequestHeader(d,a.header[d]);a.data&&(c.setRequestHeader("X-Requested-With","XMLHttpRequest"),"application/json"===a.contentType?c.setRequestHeader("Content-type","application/json; charset=UTF-8"):c.setRequestHeader("Content-type","application/x-www-form-urlencoded")),c.send(a.data||null)},v.log=function(){if(d.showLog&&"object"==typeof console&&console.log)try{console.log.apply(console,arguments)}catch(a){console.log(arguments[0])}},v.cookie={get:function(a){for(var b=a+"=",c=n.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null},set:function(a,b,c,d,e){var f="",g="",h="";if(c=void 0===c?730:c,d){var i=n.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),j=i?i[0]:"";f=j?"; domain=."+j:""}if(0!==c){var k=new Date;k.setTime(k.getTime()+24*c*60*60*1e3),g="; expires="+k.toGMTString()}e&&(h="; secure"),n.cookie=a+"="+encodeURIComponent(b)+g+"; path=/"+f+h},remove:function(a,b){v.cookie.set(a,"",-1,b)}},v.localStorage={get:function(a){return window.localStorage.getItem(a)},parse:function(a,b){var c=b;try{var d=v.localStorage.get(a);c=e.parse(d)||b||{}}catch(a){}return c},set:function(a,b){(v.isArray(b)||v.isObject(b))&&(b=e.stringify(b)),window.localStorage.setItem(a,b)},remove:function(a){window.localStorage.removeItem(a)}},v.info={campaignParams:function(){var a="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),b="",c={};return v.each(a,function(a){b=v.getQueryParam(location.href,a),b.length&&(c[a]=b)}),c},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":0===a.search("https?://(.*)bing.com")?"bing":0===a.search("https?://(.*)yahoo.com")?"yahoo":0===a.search("https?://(.*)duckduckgo.com")?"duckduckgo":0===a.search("https?://(.*)sogou.com")?"sogou":0===a.search("https?://(.*)so.com")?"360so":null},browser:function(a,b,c){var b=b||"";return c||v.includes(a," OPR/")?v.includes(a,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":v.includes(a,"IEMobile")||v.includes(a,"WPDesktop")?"Internet Explorer Mobile":v.includes(a,"Edge")?"Microsoft Edge":v.includes(a,"FBIOS")?"Facebook Mobile":v.includes(a,"Chrome")?"Chrome":v.includes(a,"CriOS")?"Chrome iOS":v.includes(b,"Apple")?v.includes(a,"Mobile")?"Mobile Safari":"Safari":v.includes(a,"Android")?"Android Mobile":v.includes(a,"Konqueror")?"Konqueror":v.includes(a,"Firefox")?"Firefox":v.includes(a,"MSIE")||v.includes(a,"Trident/")?"Internet Explorer":v.includes(a,"Gecko")?"Mozilla":""},browserVersion:function(a,b,c){var d=v.info.browser(a,b,c),e={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/Chrome\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/},f=e[d];if(void 0==f)return null;var g=a.match(f);return g?String(parseFloat(g[g.length-2])):null},os:function(){var a=o;return/Windows/i.test(a)?/Phone/.test(a)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(a)?"iOS":/Android/.test(a)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Mac/i.test(a)?"Mac OS X":/Linux/.test(a)?"Linux":""},device:function(a){return/iPad/.test(a)?"iPad":/iPod/i.test(a)?"iPod":/iPhone/i.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Windows Phone/i.test(a)?"Windows Phone":/Windows/i.test(a)?"Windows":/Macintosh/i.test(a)?"Macintosh":/Android/i.test(a)?"Android":/Linux/i.test(a)?"Linux":""},referringDomain:function(a){var b=a.split("/");return b.length>=3?b[2]:""},getBrowser:function(){return{b_dollar_browser:f.browser.name,b_dollar_browser_version:String(f.browser.version)}},getWindow:function(){var a,b;return window.innerWidth?a=window.innerWidth:n.body&&n.body.clientWidth&&(a=n.body.clientWidth),window.innerHeight?b=window.innerHeight:n.body&&n.body.clientHeight&&(b=n.body.clientHeight),n.documentElement&&n.documentElement.clientHeight&&n.documentElement.clientWidth&&(b=n.documentElement.clientHeight,a=n.documentElement.clientWidth),{b_dollar_win_width:a,b_dollar_win_height:b}},properties:function(){var a=n.body&&n.body.getElementsByTagName("h1"),b="";return a&&a.length&&a.length>0&&(b=a[0].innerText||a.textContent||""),v.extend(v.generateNewProperties({b_dollar_os:f.os.name,b_dollar_os_version:f.os.fullVersion,b_dollar_device:f.device.name,b_dollar_device_version:f.device.fullVersion}),{b_dollar_screen_height:screen.height,b_dollar_screen_width:screen.width,b_dollar_page_title:n.title,b_dollar_page_h1:b,b_dollar_page_referrer:n.referrer,b_dollar_page_url:location.href,b_dollar_page_url_path:location.pathname,b_dollar_lib:"js",b_dollar_lib_version:p},v.info.getBrowser())},currentProps:{},register:function(a){v.extend(v.info.currentProps,a)},currentSubject:{},registerSubject:function(a){v.extend(v.info.currentSubject,a)},currentObject:{},registerObject:function(a){v.extend(v.info.currentObject,a)}},v.urlQueryString=function(a,b,c,d){var e,f;return b&&"string"==typeof b||(b=window.location[d?"hash":"search"]),(f=b.indexOf(d?"#":"?"))<0?null:(e="&"+b.slice(f+1),e&&new RegExp("&"+a+"=([^&#]*)").test(e)?c?RegExp.$1:unescape(RegExp.$1):null)},b.exports=v},{"./JSON":1,"./config":2,"./uaDetector":9}],11:[function(a,b,c){var d=a("../../utils"),e=a("../../config"),f={key:function(){return this._key||(this._key=e.LIB_KEY+"HM"),this._key},jsUrl:"http://stream.ruixuesoft.com/sdk/src/widget/heatmap/index.js",cssUrl:"http://stream.ruixuesoft.com/sdk/src/widget/heatmap/index.css",parser:function(){d.urlQueryString(this.key())&&this.loadResource()},loadResource:function(){var a=document.getElementsByTagName("script")[0],b=document.getElementById(e.LIB_KEY+"_heatmap_js");b||(b=document.createElement("script"),b.id=e.LIB_KEY+"_heatmap_js",b.setAttribute("src",this.jsUrl),a.parentNode.insertBefore(b,a));var c=document.getElementById(e.LIB_KEY+"_heatmap_css");c||(c=document.createElement("link"),c.id=e.LIB_KEY+"_heatmap_css",c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",this.cssUrl),a.appendChild(c))}};b.exports=f},{"../../config":2,"../../utils":10}]},{},[6]);
