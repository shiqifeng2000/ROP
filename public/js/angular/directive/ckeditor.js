"use strict";!function(angular){function editorDirective(){return{restrict:"A",require:["ngModel","ropWYSIWYGEditor"],controller:EditorCtrl,controllerAs:"ctrl",bindToController:!0,link:function(scope,element,attrs,controllers){var ngModelCtrl=controllers[0],editorCtrl=controllers[1];editorCtrl.configureNgModel(ngModelCtrl,attrs)}}}function EditorCtrl($element,$attrs,$scope,$animate,$q,$mdInkRipple,$mdUtil,$timeout){this.$animate=$animate,this.$q=$q,this.$mdInkRipple=$mdInkRipple,this.$mdUtil=$mdUtil,this.$element=$element,this.$scope=$scope,this.$timeout=$timeout,this.ngModelCtrl=null,this.config=$parse($attrs.ckeditor)($scope)||{},this.readyDeferred=$q.defer();var self=this;this.instance=CKEDITOR.replace(this.$element[0],config),this.instance.on("instanceReady",function(){self.readyDeferred.resolve(!0)}),this.ready=function(){return self.readyDeferred.promise},$scope.$on("$destroy",function(){self.readyDeferred.promise.then(function(){self.instance.destroy(!1)})})}var model=angular.module("rop.module.WYSIWYGEditor",[]);model.directive("ropWYSIWYGEditor",editorDirective),EditorCtrl.$inject=["$element","$attrs","$scope","$animate","$q","$mdConstant","$mdTheming","$$mdDateUtil","$mdDateLocale","$mdInkRipple","$mdUtil","$timeout"],EditorCtrl.prototype.configureNgModel=function(ngModelCtrl,attrs){this.ngModelCtrl=ngModelCtrl;var self=this;self.ready().then(function(){["dataReady","change","blur","saveSnapshot"].forEach(function(event){self.onCKEvent(event,function(){self.ngModelCtrl.$setViewValue(self.instance.getData()||"")})}),["dataReady","change","blur","saveSnapshot"].forEach(function(event){self.instance.on(event,function(){self.ngModelCtrl.$setViewValue(self.instance.getData()||"")})})}),ngModelCtrl.$render=function(){self.ready().then(function(){self.instance.setData(ngModelCtrl.$viewValue||"",{noSnapshot:!0,callback:function(){self.instance.fire("updateSnapshot")}})})}}}(window.angular);