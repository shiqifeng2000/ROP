"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),controllerModule=angular.module("supplier.controllers",[]);controllerModule.config(["$provide","$logProvider","$compileProvider",function($provide,$logProvider,$compileProvider){$logProvider.debugEnabled(!1),$compileProvider.debugInfoEnabled(!1)}]).controller("IndexCtrl",["$scope","$injector",function($scope,$injector){require(["supplier/controllers/index"],function(IndexController){$injector.invoke(IndexController,void 0,{$scope:$scope}),$scope.$digest()})}]).controller("DocumentCtrl",["$rootScope","$scope","$http","$filter","$q","$cookies","$stateParams","$mdSidenav","$mdDialog","$timeout","$state",function($rootScope,$scope,$http,$filter,$q,$cookies,$stateParams,$mdSidenav,$mdDialog,$timeout,$state){$scope.defaultDetails={api_name:"API名字"},$scope.nav={entry:"api",subEntry:"",subDomains:[]},$scope.breadcrumbs=[],$scope.selectedEntry=0,$scope.cat={cat_list:[],_selectedItem:0},$scope.makeDebugUrl=function(api){return Constant.protocol+"://"+Constant.host+"/ApiTool/index?sign="+api},$scope.makeSDKUrl=function(api){return Constant.protocol+"://"+Constant.host+"/welcome/sdkTool"},$scope.simpleAPILevelDescription=function(){};var getCatQ=(function(){function DynamicItems(list){_classCallCheck(this,DynamicItems),this.list=list,this.PAGE_SIZE=10,this.loadedPages={};for(var i=0;i<Math.ceil(this.list.length/this.PAGE_SIZE);i++)this.loadedPages[i]=[],this.loadedPages[i]=this.list.slice(i*this.PAGE_SIZE,(i+1)*this.PAGE_SIZE)}return _createClass(DynamicItems,[{key:"getItemAtIndex",value:function(index){var pageNumber=Math.floor(index/this.PAGE_SIZE),page=this.loadedPages[pageNumber];return page?page[index%this.PAGE_SIZE]:[]}},{key:"getLength",value:function(){return this.list.length}}]),DynamicItems}(),function(){if(!$scope.loading)return $scope.loading=!0,$http.post("/agent",{module:"supplier",partial:"document",api:"get_ssv_cat",param:{ssv_user_id:$rootScope.ssv_user_id}}).then(function(body){if($scope.originalCat={cat_list:body.data.cat_list,_selectedItem:0},body.data&&body.data.cat_list&&body.data.cat_list.length){if($scope.cat={cat_list:body.data.cat_list,_selectedItem:0},$scope.cat.cat_list)for(var j=0;j<$scope.cat.cat_list.length;j++){if("document.domain"==$state.current.name&&$scope.cat.cat_list[j].domain_list){$scope.apiCategoryId==$scope.cat.cat_list[j].cat_id&&($scope.cat._selectedItem=j);for(var i=0;i<$scope.cat.cat_list[j].domain_list.length;i++)($rootScope.ssv_info.id?$rootScope.ssv_info.id.toLowerCase():"")==($scope.cat.cat_list[j].domain_list[i].domain_id?$scope.cat.cat_list[j].domain_list[i].domain_id.toLowerCase():"")&&($scope.apiCategoryId||($scope.apiCategoryId=$scope.cat.cat_list[j].cat_id,$scope.cat._selectedItem=j),$scope.apiCategoryName||($scope.apiCategoryName=$scope.cat.cat_list[j].cat_name))}if($scope.cat.cat_list[j].group_list){$scope.cat.cat_list[j]._selectedItem=0,$scope.apiCategoryId==$scope.cat.cat_list[j].cat_id&&($scope.cat._selectedItem=j);for(var _i=0;_i<$scope.cat.cat_list[j].group_list.length;_i++)if($scope.cat.cat_list[j].group_list[_i].api_list)for(var k=0;k<$scope.cat.cat_list[j].group_list[_i].api_list.length;k++)($rootScope.ssv_info.id?$rootScope.ssv_info.id.toLowerCase():"")==($scope.cat.cat_list[j].group_list[_i].api_list[k].api_id?$scope.cat.cat_list[j].group_list[_i].api_list[k].api_id.toLowerCase():"")&&($scope.cat.cat_list[j]._selectedItem=_i,$scope.apiCategoryId||($scope.apiCategoryId=$scope.cat.cat_list[j].cat_id,$scope.cat._selectedItem=j),$scope.apiCategoryName||($scope.apiCategoryName=$scope.cat.cat_list[j].cat_name))}}}else $scope.cat={cat_list:body.data.cat_list,_selectedItem:0},$rootScope.alert("当前供应商没有任何API发布")},function(why){$rootScope.alert(why)})["finally"](function(){$scope.loading=!1})});$scope.toAPIDetail=function(api,cat){if($scope.apiDetails.api_id==api.api_id||$scope.refreshing)return $q.reject();$scope.refreshing=!0;var cat_id=cat.cat_id;$scope.apiCategoryName=cat.cat_name,cat_id&&($scope.apiCategoryId=cat_id),$scope.apiDetails=angular.extend({},$scope.apiDetails,api),$scope.apiDetailQ=$scope.getAPIDetailQ($scope.apiDetails.api_id,$scope.apiCategoryId).then(function(){$rootScope.go("document.api",{id:api.api_id,cat_id:cat_id,cat_name:cat.cat_name})})},$scope.toDomainDetail=function(domain,cat){if($scope.domainDetails.domain_id==domain.domain_id||$scope.refreshing)return $q.reject();$scope.refreshing=!0;var cat_id=cat.cat_id;$scope.apiCategoryName=cat.cat_name,cat_id&&($scope.apiCategoryId=cat_id),$scope.domainDetails=angular.extend({},$scope.domainDetails,domain),$scope.domainDetailQ=$scope.getDomainDetailQ($scope.domainDetails.domain_id,$scope.apiCategoryId,!1).then(function(){$rootScope.go("document.domain",{id:domain.domain_id,cat_id:cat_id,cat_name:cat.cat_name,sub_domain:!1})})},$scope.changeAPISearch=function(){var cat=JSON.parse(JSON.stringify($scope.originalCat));if(cat.cat_list){if($scope.apiCategoryId){for(var j=0;j<cat.cat_list.length;j++)if($scope.apiCategoryId==cat.cat_list[j].cat_id&&(cat._selectedItem=j),cat.cat_list[j].group_list){cat.cat_list[j]._selectedItem=0;for(var i=0;i<cat.cat_list[j].group_list.length;i++)if(cat.cat_list[j].group_list[i].api_list)for(var _k=0;_k<cat.cat_list[j].group_list[i].api_list.length;_k++)$scope.apiCategoryId==cat.cat_list[j].group_list[i].api_list[_k].api_id&&(cat.cat_list[j]._selectedItem=i)}}else if($scope.cat)for(var _j=0;_j<cat.cat_list.length;_j++)cat._selectedItem=$scope.cat._selectedItem,cat.cat_list&&cat.cat_list[_j]&&cat.cat_list[_j].group_list&&$scope.cat.cat_list&&$scope.cat.cat_list[_j]&&$scope.cat.cat_list[_j].group_list&&(cat.cat_list[_j]._selectedItem=$scope.cat.cat_list[_j]._selectedItem);$scope.cat=cat}if($scope.cat.cat_list){for(var _j2=0;_j2<$scope.cat.cat_list.length;_j2++){if($scope.cat.cat_list[_j2].domain_list)for(var k=$scope.cat.cat_list[_j2].domain_list.length;k--;)$scope.cat.cat_list[_j2].domain_list[k].domain_name.indexOf($scope.apiSearch)==-1&&$scope.cat.cat_list[_j2].domain_list[k].domain_title.indexOf($scope.apiSearch)==-1&&$scope.cat.cat_list[_j2].domain_list.splice(k,1);if($scope.cat.cat_list[_j2].group_list)for(var _i2=0;_i2<$scope.cat.cat_list[_j2].group_list.length;_i2++)if($scope.cat.cat_list[_j2].group_list[_i2].api_list)for(var k1=$scope.cat.cat_list[_j2].group_list[_i2].api_list.length;k1--;)$scope.cat.cat_list[_j2].group_list[_i2].api_list[k1].api_name.indexOf($scope.apiSearch)==-1&&$scope.cat.cat_list[_j2].group_list[_i2].api_list[k1].api_title.indexOf($scope.apiSearch)==-1&&$scope.cat.cat_list[_j2].group_list[_i2].api_list.splice(k1,1)}if(!$scope.apiCategoryId)for(var _j3=$scope.cat.cat_list.length;_j3--;)if($scope.cat.cat_list[_j3].group_list)for(var _k2=$scope.cat.cat_list[_j3].group_list.length;_k2--;)$scope.cat.cat_list[_j3].group_list[_k2].api_list&&0==$scope.cat.cat_list[_j3].group_list[_k2].api_list.length&&($scope.cat.cat_list[_j3].group_list.length>1?$scope.cat.cat_list[_j3].group_list.splice(_k2,1):$scope.cat.cat_list.length>1?$scope.cat.cat_list.splice(_j3,1):1==$scope.cat.cat_list.length&&(cat.cat_list[_j3]._selectedItem=_j3))}},$scope.catQ=getCatQ(),$scope.reset=function(){$scope.breadcrumbs=[],$scope.apiDetails=$scope.defaultDetails,$scope.domainDetails=$scope.defaultDetails,$scope.selectedEntry=0,$scope.apiSearch&&$scope.catQ.then(function(){return $scope.apiSearch="",$scope.changeAPISearch(),$q.when()}),$scope.apiCategoryId=void 0,$scope.apiCategoryName=void 0,$scope.refreshing=!1},$scope.reset(),$scope.resetView=function(){$scope.refreshing||($scope.reset(),$rootScope.go("document"))},$scope.getAPIDetailQ=function(api_id,locate){return $scope.catQ.then(function(){return $rootScope.ajax("api_detail",{api_id:api_id}).then(function(data){data&&data.data_list&&data.data_list.length?$scope.apiDetails=angular.extend($scope.apiDetails,data.data_list[0]):$scope.apiDetails=$scope.defaultDetails,$scope.breadcrumbs=[$scope.apiDetails],$scope.apiDetails.api_id=api_id,!$scope.apiCategoryId&&($scope.apiCategoryId=$scope.apiDetails.cat_id),!$scope.apiCategoryName&&($scope.apiCategoryName=$scope.apiDetails.cat_name),$scope.selectedEntry=0,$scope.apiDetails.api_desc&&($scope.apiDetails.api_desc_expanded=!0),$scope.apiDetails.sysparam_expanded=!1,$scope.apiDetails.request_parameter_type&&($scope.apiDetails.request_parameter_type_expanded=!0),$scope.apiDetails.request_parameter_example&&($scope.apiDetails.request_parameter_example_expanded=!0),$scope.apiDetails.response_parameter_desc&&($scope.apiDetails.response_parameter_desc_expanded=!0),$scope.apiDetails.response_parameter_example&&($scope.apiDetails.response_parameter_example_expanded=!0),$scope.apiDetails.busparam&&$scope.apiDetails.busparam.length&&($scope.apiDetails.busparam_expanded=!0),$scope.apiDetails.result&&$scope.apiDetails.result.length&&($scope.apiDetails.result_expanded=!0),$scope.apiDetails.return_example_xml&&($scope.apiDetails.return_example_xml_expanded=!0),$scope.apiDetails.error_example_xml_expanded=!1,$scope.apiDetails.buserror&&($scope.apiDetails.buserror_expanded=!0),$scope.apiDetails.syserror_expanded=!1,$scope.apiDetails.debug_expanded=!0;try{if(!$scope.selectedEntry&&$scope.apiCategoryId){var return_example_xml=$filter("unescapeHtml")($scope.apiDetails.return_example_xml,"xml"),error_example_xml=$filter("unescapeHtml")($scope.apiDetails.error_example_xml,"xml"),return_example_json=$filter("unescapeHtml")($scope.apiDetails.return_example_json,"json"),error_example_json=$filter("unescapeHtml")($scope.apiDetails.error_example_json,"json");packageTree(return_example_xml||""),packageTreeError(error_example_xml||""),Process(return_example_json||"{}"),ProcessError(error_example_json||"{}")}}catch(e){window.teste=e}$timeout(function(){if(locate&&$scope.cat.cat_list)for(var j=0;j<$scope.cat.cat_list.length;j++)if($scope.cat.cat_list[j].group_list)for(var i=0;i<$scope.cat.cat_list[j].group_list.length;i++)if($scope.cat.cat_list[j].group_list[i].api_list)for(var k=0;k<$scope.cat.cat_list[j].group_list[i].api_list.length;k++)api_id==$scope.cat.cat_list[j].group_list[i].api_list[k].api_id&&($scope.cat.cat_list[j].group_list[i]._api_index=k)},300)})})["finally"](function(){$rootScope.ssv_info&&delete $rootScope.ssv_info.id,$scope.refreshing=!1,window.rxStream&&window.rxStream.track("rop_ssv_document_visit",{properties:{b_rop_ssv_document_name:$scope.apiDetails&&$scope.apiDetails.api_name||"未知页面"}})})},"document.api"==$state.current.name&&($scope.apiDetailQ=$scope.getAPIDetailQ($state.params.id,window.ssv_info&&window.ssv_info.cat_id)),$scope.getDomainDetailQ=function(domain_id,locate,sub_domain){return $scope.catQ.then(function(){return $rootScope.ajax("domain_detail",{domain_id:domain_id}).then(function(data){data&&data.data_list&&data.data_list.length?$scope.domainDetails=data.data_list[0]:$scope.domainDetails=$scope.defaultDetails,$scope.breadcrumbs=[$scope.domainDetails],$scope.domainDetails.domain_id=domain_id,!$scope.apiCategoryId&&($scope.apiCategoryId=$scope.domainDetails.cat_id),!$scope.apiCategoryName&&($scope.apiCategoryName=$scope.domainDetails.cat_name),$scope.selectedEntry=1,$scope.domainDetails.domain_desc&&($scope.domainDetails.domain_desc_expanded=!0),$scope.domainDetails.property&&($scope.domainDetails.property_expanded=!0),$timeout(function(){var j=$scope.cat._selectedItem;if(sub_domain&&$scope.cat.cat_list&&$scope.cat.cat_list[j]&&$scope.cat.cat_list[j].group_list)for(var i=0;i<$scope.cat.cat_list[j].group_list.length;i++)if($scope.cat.cat_list[j]._domain_index=0,$scope.cat.cat_list[j].domain_list)for(var k=0;k<$scope.cat.cat_list[j].domain_list.length;k++)$scope.cat.cat_list[j].domain_list[k].domain_id.toLowerCase()==$scope.domainDetails.domain_id.toLowerCase()&&($scope.cat.cat_list[j]._domain_index=k)},500)})})["finally"](function(){$rootScope.ssv_info&&delete $rootScope.ssv_info.id,$scope.refreshing=!1,window.rxStream&&window.rxStream.track("rop_ssv_document_visit",{properties:{b_rop_ssv_document_name:$scope.domainDetails&&$scope.domainDetails.domain_name||"未知页面"}})})},"document.domain"==$state.current.name&&($scope.domainDetailQ=$scope.getDomainDetailQ($state.params.id,window.ssv_info&&window.ssv_info.cat_id,!0)),$scope.selectEntry=function(entry){$scope.selectedEntry=entry,$scope.refreshing||(!entry&&$scope.apiDetails&&$scope.apiDetails.api_id?"document.api"!=$state.current.name&&"document"!=$state.current.name&&$rootScope.go("document.api",{id:$scope.apiDetails.api_id,cat_id:$scope.apiCategoryId,cat_name:$scope.apiCategoryName}):entry&&$scope.domainDetails&&$scope.domainDetails.domain_id&&"document.domain"!=$state.current.name&&"document"!=$state.current.name&&$rootScope.go("document.domain",{id:$scope.domainDetails.domain_id,cat_id:$scope.apiCategoryId,cat_name:$scope.apiCategoryName}))},$scope.toSubDomain=function(domain_id,details){return $scope.refreshing||!domain_id?$q.reject():($scope.refreshing=!0,void($scope.domainDetailQ=$scope.getDomainDetailQ(domain_id,$scope.apiCategoryId,!1).then(function(){$rootScope.go("document.domain",{id:domain_id,cat_id:$scope.apiCategoryId,cat_name:$scope.apiCategoryName,sub_domain:!0})})))},$scope.levelHint=function($event){function DialogController($scope,$mdDialog){$scope.closeDialog=function(){$mdDialog.hide()}}$event.preventDefault(),$event.stopPropagation();angular.element(document.body);$mdDialog.show({targetEvent:$event,clickOutsideToClose:!0,fullscreen:!1,template:'\n                    <md-dialog aria-label="List dialog" class="level-description">\n                        <md-dialog-content style="padding: 32px;">\n                            <p><span style="font-size:12px;">开放平台API目前分为低级、中级、高级，根据API的等级不同，需要使用对应的调用方式。</span></p>        \n                            <p><md-button class="md-raised low-rank" aria-label="Settings">初级API</md-button>可以使用ACCESS_TOKEN模式和安全签名方式进行调用</p>\n                            <p><md-button class="md-raised medium-rank" aria-label="Settings">中级API</md-button>可以使用ACCESS_TOKEN模式和安全签名方式进行调用</p>\n                            <p><md-button class="md-raised high-rank" aria-label="Settings">高级API</md-button>只可以使用安全签名方式进行调用。</p>\n                            <br /> \n                            <p><span style="font-size:12px;">供应商在发布API时，目前系统会自动根据供应商安全等级分配API调用等级，后续版本将会开放供应商自行设置API调用等级。</span></p>\n                            <p><span style="font-size:12px;">当API调用等级比较低时，供应商应处理好服务器的调用安全性，确保数据的安全。</span></p>\n                            <p><span style="font-size:12px;">开发者在调用初级和中级API时，必须使用https方式进行调用，保证数据传输中的安全性。</span></p>\n                            <br />\n                            <p>具体调用方式请参照</p>\n                            <p><a href="http://open.rongcapital.cn/welcome/doc/4D41D81C-CBB1-4567-8D15-ACC16EE025C8" target="_blank">Secret签名模式调用API </a></p>\n                            <p><a href="http://open.rongcapital.cn/welcome/doc/1109A17A-5873-420E-A590-C4CE6C5A2D59" target="_blank">ACCESS_TOKEN模式调用API</a></p>\n                            <p><a href="http://open.rongcapital.cn/welcome/doc/792E3864-2481-42B9-9CD2-4D4B83F3B294" target="_blank">前端调用模式说明</a></p>\n                        </md-dialog-content>\n                        <md-dialog-actions>\n                            <md-button ng-click="closeDialog()" class="md-raised">关闭我</md-button>\n                        </md-dialog-actions>\n                    </md-dialog>',controller:DialogController})},$scope.initClipboard=function(cliper){var _lang=$cookies.get("_lang");cliper.beforeClipboardCopy="zh-cn"==_lang?"复制文档地址":"Copy document URL",cliper.afterClipboardCopy="zh-cn"==_lang?"已复制":"Copied",cliper.workaroundSupportClipboard=function(action){var actionMsg=" 来"+("cut"===action?"剪切":"拷贝"),actionKey="cut"===action?"X":"C";return actionMsg=/iPhone|iPad/i.test(navigator.userAgent)?"暂不支持iPhone和iPad :(":/Mac/i.test(navigator.userAgent)?"请按 ⌘-"+actionKey+actionMsg:"请按 Ctrl-"+actionKey+actionMsg},$scope.clipboardHints=cliper.beforeClipboardCopy},window.test=$scope,$rootScope.removeLoading()}]).controller("APICtrl",["$rootScope","$scope","$http","$filter","$q","$cookies","$stateParams","$mdSidenav","$mdDialog","$timeout","$state",function($rootScope,$scope,$http,$filter,$q,$cookies,$stateParams,$mdSidenav,$mdDialog,$timeout,$state){var api_id=$stateParams.id,cliperParam={};($scope.apiDetails&&$scope.apiDetails.api_id&&api_id.toLowerCase()!=$scope.apiDetails.api_id.toLowerCase()||!$scope.apiCategoryId||!$scope.apiDetails||!$scope.apiDetails.api_id)&&($scope.$parent.apiDetails=$scope.defaultDetails,$scope.apiDetailQ=$scope.getAPIDetailQ(api_id,window.ssv_info&&window.ssv_info.cat_id||$scope.apiCategoryId)),$scope.$parent.selectedEntry=0;try{if(!$scope.selectedEntry&&$scope.apiCategoryId){var return_example_xml=$filter("unescapeHtml")($scope.apiDetails.return_example_xml,"xml"),error_example_xml=$filter("unescapeHtml")($scope.apiDetails.error_example_xml,"xml"),return_example_json=$filter("unescapeHtml")($scope.apiDetails.return_example_json,"json"),error_example_json=$filter("unescapeHtml")($scope.apiDetails.error_example_json,"json");packageTree(return_example_xml||""),packageTreeError(error_example_xml||""),Process(return_example_json||"{}"),ProcessError(error_example_json||"{}")}}catch(e){window.teste=e}window.ssv_info.cat_id?($scope.apiDetailQ.then(function(){$timeout(function(){var activeElement=document.querySelector("body .document .section-wrapper section md-sidenav.md-sidenav-left.collapsed .md-expand>md-content md-list-item.active");activeElement&&activeElement.scrollIntoViewIfNeeded()},500),$scope.copyToClipboard=function(details){var id=details.api_id?details.api_id:details.domain_id,method=details.api_id?"ApiMethod":"ApiDomain";return Constant.protocol+"://"+Constant.host+"/api/"+method+"-"+id+".html"}}),delete window.ssv_info.cat_id,delete window.ssv_info.cat_name):$timeout(function(){$scope.apiDetailQ.then(function(){$timeout(function(){var activeElement=document.querySelector("body .document .section-wrapper section md-sidenav.md-sidenav-left.collapsed .md-expand>md-content md-list-item.active");activeElement&&activeElement.scrollIntoViewIfNeeded()},500),$scope.copyToClipboard=function(details){var id=details.api_id?details.api_id:details.domain_id,method=details.api_id?"ApiMethod":"ApiDomain";return Constant.protocol+"://"+Constant.host+"/api/"+method+"-"+id+".html"}})},100),$scope.initClipboard(cliperParam);var cliper=new Clipboard(".cliper");cliper.on("success",function(e){$scope.clipboardHints==cliperParam.beforeClipboardCopy&&(e.clearSelection(),$timeout(function(){$scope.clipboardHints=cliperParam.afterClipboardCopy}),$timeout(function(){$scope.clipboardHints=cliperParam.beforeClipboardCopy},3e3))}),cliper.on("error",function(e){$scope.clipboardHints==cliperParam.beforeClipboardCopy&&($timeout(function(){$scope.clipboardHints=cliperParam.workaroundSupportClipboard(e.action)}),$timeout(function(){$scope.clipboardHints=cliperParam.beforeClipboardCopy},3e3))}),window.test1=$scope,$scope.$on("$destroy",function(){cliper&&cliper.destroy(),"document.api"!=$state.current.name&&"document.domain"!=$state.current.name&&$scope.reset()})}]).controller("DomainCtrl",["$rootScope","$scope","$http","$filter","$q","$cookies","$stateParams","$mdSidenav","$mdDialog","$timeout","$state",function($rootScope,$scope,$http,$filter,$q,$cookies,$stateParams,$mdSidenav,$mdDialog,$timeout,$state){var domain_id=$stateParams.id,sub_domain=$stateParams.sub_domain,cliperParam={};($scope.domainDetails&&$scope.domainDetails.domain_id&&domain_id.toLowerCase()!=$scope.domainDetails.domain_id.toLowerCase()||!$scope.apiCategoryId)&&($scope.$parent.domainDetails=$scope.defaultDetails,$scope.domainDetailQ=$scope.getDomainDetailQ(domain_id,window.ssv_info&&window.ssv_info.cat_id||$scope.apiCategoryId,sub_domain)),window.ssv_info.cat_id&&$scope.$parent&&($scope.$parent.selectedEntry=1),window.ssv_info.cat_id?($scope.domainDetailQ.then(function(){$scope.copyToClipboard=function(details){var id=details.api_id?details.api_id:details.domain_id,method=details.api_id?"ApiMethod":"ApiDomain";return Constant.protocol+"://"+Constant.host+"/api/"+method+"-"+id+".html"}}),delete window.ssv_info.cat_id,delete window.ssv_info.cat_name):$timeout(function(){$scope.domainDetailQ.then(function(){$scope.copyToClipboard=function(details){var id=details.api_id?details.api_id:details.domain_id,method=details.api_id?"ApiMethod":"ApiDomain";return Constant.protocol+"://"+Constant.host+"/api/"+method+"-"+id+".html"}})},100),$scope.$parent.selectedEntry=1,$scope.initClipboard(cliperParam);var cliper=new Clipboard(".cliper");cliper.on("success",function(e){$scope.clipboardHints==cliperParam.beforeClipboardCopy&&(e.clearSelection(),$timeout(function(){$scope.clipboardHints=cliperParam.afterClipboardCopy}),$timeout(function(){$scope.clipboardHints=cliperParam.beforeClipboardCopy},3e3))}),cliper.on("error",function(e){$scope.clipboardHints==cliperParam.beforeClipboardCopy&&($timeout(function(){$scope.clipboardHints=cliperParam.workaroundSupportClipboard(e.action)}),$timeout(function(){$scope.clipboardHints=cliperParam.beforeClipboardCopy},3e3))}),$scope.$on("$destroy",function(){cliper&&cliper.destroy(),"document.api"!=$state.current.name&&"document.domain"!=$state.current.name&&$scope.reset()})}]).controller("FunctionCtrl",["$rootScope","$scope","$http",function($rootScope,$scope,$http){$('a[href^="#"]',"#partials").click(function(e){e.preventDefault()});var featureQ=$http.post("/agent",{module:"supplier",partial:"function",api:"get_feature",param:{ssv_user_id:$rootScope.ssv_user_id}}).then(function(body){body&&body.data&&body.data.user_desc&&($scope.ssv_feature=body.data.user_desc)},function(why){$rootScope.alert(why)});$scope.$on("$viewContentLoaded",function(event){featureQ["finally"](function(){$rootScope.removeLoading()})})}]).controller("InfoCtrl",["$rootScope","$scope","$http",function($rootScope,$scope,$http){$('a[href^="#"]',"#partials").click(function(e){e.preventDefault()}),$scope.infos=[];var pageIndex=1,pageSize=6,infoQ=void 0;$scope.searcher=function(){return $scope.loading=!0,$http.post("/agent",{module:"supplier",partial:"info",api:"infos",param:{pageindex:pageIndex,pagesize:pageSize,ssv_user_id:$rootScope.ssv_user_id}}).then(function(body){var totalPages="number"==typeof body.data.page_count?body.data.page_count:new Number(body.data.page_count);totalPages>=pageIndex&&body.data.data_list&&body.data.data_list.length&&(body.data.data_list.forEach(function(r,i){$scope.infos.push(r)}),pageIndex++),$scope.loading=!1},function(why){$scope.loading=!1,$rootScope.alert(why)})["finally"](function(){$scope.loaded=!0})},infoQ=$scope.searcher(),window.test=$scope,$scope.$on("$viewContentLoaded",function(event){infoQ["finally"](function(){$rootScope.nextTick($rootScope.removeLoading)})})}]).controller("AllCommentCtrl",["$rootScope","$scope","$http",function($rootScope,$scope,$http){$('a[href^="#"]',"#partials").click(function(e){e.preventDefault()}),$scope.comments=[],$scope.searcher=function(){return $scope.loading=!0,$http.post("/agent",{module:"supplier",partial:"all-comment",api:"comments",param:{ssv_user_id:$rootScope.ssv_user_id}}).then(function(body){"number"==typeof body.data.page_count?body.data.page_count:new Number(body.data.page_count);body.data.data_list&&body.data.data_list.length&&$.extend($scope.comments,body.data.data_list),$scope.loading=!1},function(why){$scope.loading=!1,$rootScope.alert(why)})},$scope.saveComment=function(){return $scope.commentForm.$invalid?($scope.commentForm.$error.required&&$scope.commentForm.$error.required.forEach(function(r){r.$setDirty(!0)}),$("#flash").addClass("warn"),void setTimeout(function(){$("#flash").removeClass("warn"),$scope.$digest()},1e3)):$rootScope.profile?void $http.post("/agent",{module:"supplier",partial:"all-comment",api:"add",param:{comment_content:$scope.comment_content_area,ssv_user_id:$scope.ssv_user_id}}).then(function(body){"boolean"==typeof body.data.is_success&&body.data.is_success||"string"==typeof body.data.is_success&&"true"==body.data.is_success?($scope.commentForm.$setPristine(),$scope.comment_content_area="",$scope.searcher()):$rootScope.warn(body.data.msg)},function(why){$rootScope.alert(why)}):void $rootScope.showAdvanced()},$scope.isCurrentSsv=function(){return!(!$rootScope.profile||!$rootScope.ssv_intro)&&$rootScope.profile.login_user_name==$rootScope.ssv_intro.user_name},$scope.toggleReply=function(comment){comment._toggleReply=!comment._toggleReply},$scope.replyComment=function(comment){comment._toggleReply=!comment._toggleReply,setTimeout(function(){$http.post("/agent",{module:"supplier",partial:"all-comment",api:"reply",param:{comment_id:comment.comment_id,comment_content:comment._comment_content,ssv_user_id:$scope.ssv_user_id}}).then(function(body){"boolean"==typeof body.data.is_success&&body.data.is_success||"string"==typeof body.data.is_success&&"true"==body.data.is_success?(delete comment._comment_content,$scope.searcher()):$rootScope.alert(body.data.msg)},function(why){$rootScope.alert(why)})},400)},$scope.isCreator=function(comment){return!(!$rootScope.profile||!comment)&&$rootScope.profile.login_user_name==comment.create_user},$scope.deleteComment=function(comment,comments){$http.post("/agent",{module:"supplier",partial:"all-comment",api:"delete",param:{comment_id:comment.comment_id}}).then(function(body){"boolean"==typeof body.data.is_success&&body.data.is_success||"string"==typeof body.data.is_success&&"true"==body.data.is_success?($scope.comment_content_area="",comments.splice(comments.indexOf(comment),1)):$rootScope.alert(body.data.msg)},function(why){$rootScope.alert(why)})},$scope.checkID=function(){return!!$rootScope.profile&&($rootScope.profile.id==$scope.ssv_user_id,!0)},$scope.$on("$viewContentLoaded",function(event){$scope.searcher()["finally"]($rootScope.removeLoading)})}]);